<!doctype html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8" />
    <title>I Moved This Blog To Eleventy</title>
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/images/apple-touch-icon.png"
    />
    <link rel="icon" href="/images/favicon.ico" />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="/images/favicon-16x16.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="/images/favicon-32x32.png"
    />
    <link rel="manifest" href="/site.webmanifest" />
    <link
      rel="mask-icon"
      href="/images/safari-pinned-tab.svg"
      color="#5bbad5"
    />
    <meta name="msapplication-TileColor" content="#da532c" />
    <meta name="theme-color" content="#ffffff" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="" />

    <link
      href="https://fonts.googleapis.com/css2?family=Crimson+Pro:ital,wght@0,200..900;1,200..900&family=Inconsolata:wght@200..900&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap&family=Material+Symbols+Outlined"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/styles/katex.min.css" />
    <link rel="stylesheet" href="/styles/s-6cLx0t1Y.css" />
    <link rel="me" href="mailto:asanka@gmail.com" />
    <link rel="me" href="https://github.com/asankah" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <meta name="ai-generated" content="none" />
  </head>

  <body>
    <header class="container">
      <nav class="top" itemscope="" itemtype="https://schema.org/Blog">
        <h1 itemprop="name">
          <a href="/" itemprop="url">Strong Opinions Weekly Held</a>
        </h1>
        <span></span>

        <h2><a href="/">Home</a></h2>

        <h2 itemprop="author" itemscope="" itemtype="https://schema.org/Person">
          <a href="/about/me/" itemprop="sameAs">About</a>
        </h2>

        <h2><a href="/tags/">Tags</a></h2>
        <h2>
          <a href="/feed.xml"><img src="/images/rss.svg" /></a>
        </h2>
      </nav>
    </header>

    <article itemscope="" itemtype="https://schema.org/BlogPosting">
      <link itemprop="url" href="/posts/moved-to-eleventy/" />
      <link itemprop="isPartOf" itemtype="https://schema.org/Blog" href="/" />
      <header class="container">
        <div class="">
          <h1 itemprop="name">I Moved This Blog To Eleventy</h1>
          <nav>
            <div class="metadata">
              Published on
              <time datetime="2024-12-13" itemprop="datePublished"
                >December 13, 2024</time
              >
              by <span class="author" itemprop="author">Asanka Herath</span>.

              <br />
              Estimated reading time is <time>12 minutes</time>.
            </div>
            <span></span>
            <menu class="tags">
              <li>
                <span class="tag"> #<a href="/tags/meta/">Meta</a> </span>
              </li>
            </menu>
          </nav>
        </div>
      </header>

      <main itemprop="articleBody" class="container">
        <p>
          Astute observers of this blog may have noticed that the blog looks
          suspiciously different lately. That’s because I changed the static
          site generator I was using.
        </p>
        <p>
          Previously the
          <a href="../how-this-blog-works/">static site generator I used</a> was
          <a href="https://gohugo.io">Hugo</a>. This arrangement worked for a
          while but it had some shortcomings.
        </p>
        <h2 id="growing-pains">Growing Pains</h2>
        <p>
          I was using <a href="https://pandoc.org/">Pandoc</a> to convert
          Markdown to HTML. Hugo’s support for Pandoc had some limitations. For
          example, you can’t specify options for Pandoc or use a bibliography.
          When I moved the blog to Hugo, I lost some of these features.
          Attempting to close the gap I authored a
          <a href="https://github.com/gohugoio/hugo/pull/7529"
            >patch that added support for configuring Pandoc</a
          >.
        </p>
        <p>
          Pandoc is extensible via filtering the AST of a document through a
          series of programs which can modify it. There is no restrction on the
          kinds of programs that you can use.
        </p>
        <p>
          If Hugo allowed configuring all this via frontmatter, that may
          introduce some tricky security issues.
        </p>
        <p
          style="anchor-name: --fnref1-anchor"
          data-anchor-name="--fnref1-anchor"
        >
          Say you download a Hugo theme from the web and try to build your site.
          A theme could include frontmatter that causes Pandoc to run an unsafe
          binary. That’s not great. So it is understandable that this kind of
          feature isn’t a part of Hugo proper<a
            href="#fn1"
            class="footnote-ref"
            id="fnref1"
            role="doc-noteref"
            interestfor="fnref1-preview"
            ><sup>1</sup></a
          >. While my patch worked, it was safe only because I controlled every
          aspect of the blog.
        </p>
        <p>
          While tinkering on this was fun, it created an additional headache.
          Namely, whenever and whereever I wanted to build my blog, I had to
          maintain a custom build of Hugo. After moving my build a couple of
          times maintaining a custom build became a painful chore.
        </p>
        <h2 id="the-exodus">The Exodus</h2>
        <p>
          So started the process of looking for an easy-to-use static site
          generator (hereafter SSG). My requirements were:
        </p>
        <ul>
          <li>The SSG should support Markdown.</li>
          <li>
            Markdown should support some of the Pandoc features I was using, or
            at least have the flexibility to extend support for those features.
          </li>
          <li>Making this work should not require any custom patches.</li>
        </ul>
        <p>
          <a href="https://www.11ty.dev/">Eleventy</a> was <em>almost</em> a
          no-brainer. People had high praise for it, including developer
          relations folks at Google. So I felt like that would be an easy move.
        </p>
        <p>
          Eleventy’s Mardown support is based on
          <a href="https://github.com/markdown-it/markdown-it">Mardown-It</a>.
          One thing that I liked about Markdown-It from the start is that there
          appeared to be people who are extending it to support various features
          of Pandoc. In fact I found plugins for basically all Pandoc features
          that I used in this blog. Everything was looking quite rosy.
        </p>
        <h2 id="templating">Templating</h2>
        <h3 id="webc-eleventy-is-broken">WebC + Eleventy Is Broken</h3>
        <p
          style="anchor-name: --fnref2-anchor"
          data-anchor-name="--fnref2-anchor"
        >
          Eleventy supports a templating language called
          <a href="https://www.11ty.dev/docs/languages/webc/">WebC</a>. It
          follows the web-component way of defining layouts, but can avoid much
          of the custom element overhead by opportunistically generating plain
          HTML. I had already accepted that switching the SSG meant rewriting
          layout templates, and using web components to do that seemed like a
          good idea<a
            href="#fn2"
            class="footnote-ref"
            id="fnref2"
            role="doc-noteref"
            interestfor="fnref2-preview"
            ><sup>2</sup></a
          >.
        </p>
        <p>
          A couple of standalone WebC based templates worked fine. But the
          moment I had nested templates, Eleventy hung and eventually crashed. I
          didn’t want to go on a side quest to debug it, and ultimately that
          would’ve likely led to be violating the “no local patches” rule. So
          that was that for WebC. If WebC was more robust or just worked, it
          would have been my choice of template engine.
        </p>
        <p>
          One cool feature of using WebC with Eleventy is that bundling works
          trivially. For example, if you have a <code>&lt;script&gt;</code> tag
          or a <code>&lt;style&gt;</code> tag in a component, WebC automatically
          pulls the content into the relevant bundles. All other templating
          engines supported in Eleventy (save for third-party engines that I
          didn’t try) require manual labor to get stuff into the bundles.
        </p>
        <h3 id="nunjucks-eleventy-works">Nunjucks + Eleventy Works</h3>
        <p
          style="anchor-name: --fnref3-anchor"
          data-anchor-name="--fnref3-anchor"
        >
          The next templating language I looked at was Nunjucks. I had briefly
          looked at Liquid as well, but for my purposes Nunjucks and Liquid
          seemed to be quite similar. Nunjucks won out because it had safer
          defaults<a
            href="#fn3"
            class="footnote-ref"
            id="fnref3"
            role="doc-noteref"
            interestfor="fnref3-preview"
            ><sup>3</sup></a
          >.
        </p>
        <h2 id="handrolling">Handrolling</h2>
        <h3 id="pandoc-again">Pandoc Again</h3>
        <p>
          I tried to rely only on Markdown-It for this blog. But very soon I had
          a big stack of extensions to support the various features I needed,
          like supporting <code>&lt;div&gt;</code>s, bibliography, and
          attributes. While the Markdown-It ecosystem is extensive, it also
          introduces a lot of confusion. For example, there are multiple
          packages that all provide the same functionality and
          <em>also based on the same base package</em>. Keeping track of all
          this was starting to be a pain. Also, I had trouble getting block
          level containers working.
        </p>
        <p>
          After a while I decided not to waste time trying to replicate features
          that already existed in Pandoc. So I wrote a little library that
          invoked Pandoc within Eleventy to convert Markdown to HTML. It was a
          little slower, but worked out great.
        </p>
        <h3 id="bundling-files">Bundling Files</h3>
        <p>
          While it is possible to add content to bundles (like CSS and JS),
          curiously it was not possible to stuff files into said bundles. The
          suggested method was to do something like this:
        </p>
        <pre><code>  {% css %}
    {% include &quot;some-file.css&quot; %}

    body {
        // other CSS.
    }
  {% endcss %}</code></pre>
        <p>
          This seems like a good idea, but there is one crucial issue:
          <em
            >The contents of the included file (<code>some-file.css</code> in
            the example above) is also processed by the same templating
            engine</em
          >. If the file doesn’t contain any sequences that look like template
          tokens, then we are good. But this is asking for trouble.
        </p>
        <p>
          So I wrote a custom tag called <code>bundleFile</code> that can take
          the contents of a file and stuff it directly into a bundle. The
          earlier example now looks like this:
        </p>
        <pre><code>  {% bundleFile &quot;some-file.css&quot; %}

  {% css %}
    body {
        // other CSS
    }
  {% endcss %}</code></pre>
        <h3 id="sassy">SASSy</h3>
        <p>
          Eleventy doesn’t support SASS out of the box, but there are examples
          in the documentation for how you can set it up. But all of the
          examples assume that you have SASS or SCSS files that you are going to
          conver to CSS, and then serve without bundling. I wanted to be able to
          compile SASS and stuff the resulting CSS into a bundle.
        </p>
        <p>
          So alongside the <code>bundleFile</code> shortcode, I added a
          <code>bundleScss</code> shortcode so I can do stuff like this:
        </p>
        <pre><code>   {% bundleScss &quot;my-styles.scss&quot; %}</code></pre>
        <h3 id="katex">Katex</h3>
        <p>
          I like Katex for my math typesetting. Pandoc supports it out of the
          box. But the rendered HTML needs to invoke Katex in the client to
          render the math. I wanted to avoid this step entirely and try to
          render Katex on the server.
        </p>
        <p>
          This was a pain to do with Hugo, but since Eleventy was alredy runing
          in Node, server-side rendering is a breeze.
        </p>
        <h2 id="conclusion">Conclusion</h2>
        <p>
          Overall I found Eleventy fun to work with. My gripes are mostly with
          the documentation which lacks a reference. It’s a pain to go through
          tutorial-like documents to find out what exactly gets passed to a
          shortcode or what to do when a shortcode adds a dependency. I made way
          too many trips to the 11ty GitHub repo. The right number of required
          visits should be zero.
        </p>
        <p>
          In the coming weeks I’ll package Eleventy Pandoc support and some of
          the shortcodes so others can use them.
        </p>
        <section
          id="footnotes"
          class="footnotes footnotes-end-of-document"
          role="doc-endnotes"
        >
          <hr />
          <ol>
            <li id="fn1">
              <p>
                There are ways to mitigate this problem. For example, we could
                restrict which flags can be inherited from themes, or require
                that certain options can only be set from the top level
                <code>hugo.yaml</code> file that the user controls.<a
                  href="#fnref1"
                  class="footnote-back"
                  role="doc-backlink"
                  >↩︎</a
                >
              </p>
            </li>
            <li id="fn2">
              <p>
                Not quite all the way true because use of shadow DOM and custom
                elements was not a requirement.<a
                  href="#fnref2"
                  class="footnote-back"
                  role="doc-backlink"
                  >↩︎</a
                >
              </p>
            </li>
            <li id="fn3">
              <p>
                The defaults I’m referring to is what happens with a tag like
                <code>{{ foo }}</code> where the contents of the variable
                <code>foo</code> would be inserted into the document. Nunjucks
                will treat the contents as unsafe and requires manually opting
                into unsafe injection via <code>{{ foo | safe }}</code>. Liquid
                will insert the contents with no escaping.<a
                  href="#fnref3"
                  class="footnote-back"
                  role="doc-backlink"
                  >↩︎</a
                >
              </p>
            </li>
          </ol>
        </section>

        <aside
          id="fnref1-preview"
          class="footnote-preview"
          popover="auto"
          style="position-anchor: --fnref1-anchor"
        >
          <li id="fn1">
            <p>
              There are ways to mitigate this problem. For example, we could
              restrict which flags can be inherited from themes, or require that
              certain options can only be set from the top level
              <code>hugo.yaml</code> file that the user controls.<a
                href="#fnref1"
                class="footnote-back"
                role="doc-backlink"
                >↩︎</a
              >
            </p>
          </li>
        </aside>
        <aside
          id="fnref2-preview"
          class="footnote-preview"
          popover="auto"
          style="position-anchor: --fnref2-anchor"
        >
          <li id="fn2">
            <p>
              Not quite all the way true because use of shadow DOM and custom
              elements was not a requirement.<a
                href="#fnref2"
                class="footnote-back"
                role="doc-backlink"
                >↩︎</a
              >
            </p>
          </li>
        </aside>
        <aside
          id="fnref3-preview"
          class="footnote-preview"
          popover="auto"
          style="position-anchor: --fnref3-anchor"
        >
          <li id="fn3">
            <p>
              The defaults I’m referring to is what happens with a tag like
              <code>{{ foo }}</code> where the contents of the variable
              <code>foo</code> would be inserted into the document. Nunjucks
              will treat the contents as unsafe and requires manually opting
              into unsafe injection via <code>{{ foo | safe }}</code>. Liquid
              will insert the contents with no escaping.<a
                href="#fnref3"
                class="footnote-back"
                role="doc-backlink"
                >↩︎</a
              >
            </p>
          </li>
        </aside>
      </main>

      <footer class="container">
        <div>
          <p>
            Last modified: <time datetime="2024-12-13">December 13, 2024</time>
          </p>
        </div>
      </footer>
    </article>

    <div class="container"></div>

    <footer class="container">
      <h2>More posts from this blog ...</h2>
      <div
        class="post-summary"
        itemscope=""
        itemtype="https://schema.org/BlogPosting"
      >
        <link itemprop="isPartOf" itemtype="https://schema.org/Blog" href="/" />
        <h2 class="title">
          <a itemprop="url" href="/posts/inktober-stripes/">
            <span itemprop="name">Inktober - Stripes</span>
          </a>
        </h2>
        <div class="summary-row">
          <div>
            <nav>
              <small>
                Published on
                <time datetime="2022-01-21" itemprop="datePublished"
                  >January 21, 2022</time
                >.
              </small>
              <span></span>
              <menu class="tags">
                <li>
                  <span class="tag">
                    #<a href="/tags/inktober/">Inktober</a>
                  </span>
                </li>
              </menu>
            </nav>
            <p class="more">
              <a href="/posts/inktober-stripes/">Read more …</a>
            </p>
          </div>
        </div>
      </div>

      <div
        class="post-summary"
        itemscope=""
        itemtype="https://schema.org/BlogPosting"
      >
        <link itemprop="isPartOf" itemtype="https://schema.org/Blog" href="/" />
        <h2 class="title">
          <a itemprop="url" href="/posts/git-autopush/">
            <span itemprop="name"
              >Use Git hooks to automatically push after every commit</span
            >
          </a>
        </h2>
        <div class="summary-row">
          <div>
            <nav>
              <small>
                Published on
                <time datetime="2022-07-05" itemprop="datePublished"
                  >July 5, 2022</time
                >.
              </small>
              <span></span>
              <menu class="tags">
                <li>
                  <span class="tag"> #<a href="/tags/tools/">Tools</a> </span>
                </li>
              </menu>
            </nav>
            <div class="summary-row">
              <div itemprop="abstract">
                <p>
                  During before and after various Git operations, Git invokes
                  special hooks that can be used execute custom scripts. This
                  article explains how to use them to automatically push to an
                  upstream repository every time you make a commit to a local
                  repo.
                </p>
              </div>
            </div>
            <p class="more"><a href="/posts/git-autopush/">Read more …</a></p>
          </div>
        </div>
      </div>

      <div
        class="post-summary"
        itemscope=""
        itemtype="https://schema.org/BlogPosting"
      >
        <link itemprop="isPartOf" itemtype="https://schema.org/Blog" href="/" />
        <h2 class="title">
          <a itemprop="url" href="/series/structure-of-experience/meaning/"
            ><span class="series-name">Structure Of Experience</span>:
            <span itemprop="name">Act I: Meaning</span>
          </a>
        </h2>
        <div class="summary-row">
          <div>
            <nav>
              <small>
                Published on
                <time datetime="2025-05-04" itemprop="datePublished"
                  >May 4, 2025</time
                >.
              </small>
              <span></span>
              <menu class="tags">
                <li>
                  <span class="tag"> #<a href="/tags/ai/">AI</a> </span>
                </li>
              </menu>
            </nav>
            <div class="summary-row">
              <div itemprop="abstract">
                <p>
                  Language builds meaning by combining your inner experiences.
                </p>
              </div>
            </div>
            <p class="more">
              <a href="/series/structure-of-experience/meaning/">Read more …</a>
            </p>
          </div>
        </div>
      </div>

      <div
        class="post-summary"
        itemscope=""
        itemtype="https://schema.org/BlogPosting"
      >
        <link itemprop="isPartOf" itemtype="https://schema.org/Blog" href="/" />
        <h2 class="title">
          <a itemprop="url" href="/series/unsung-team-roles/glue-people/"
            ><span class="series-name">Unsung Team Roles</span>:
            <span itemprop="name">Ode to Glue People</span>
          </a>
        </h2>
        <div class="summary-row">
          <div>
            <nav>
              <small>
                Published on
                <time datetime="2025-08-12" itemprop="datePublished"
                  >August 12, 2025</time
                >.
              </small>
              <span></span>
              <menu class="tags">
                <li>
                  <span class="tag">
                    #<a href="/tags/organizations/">Organizations</a>
                  </span>
                </li>
              </menu>
            </nav>
            <div class="summary-row">
              <div itemprop="abstract">
                <p>
                  While managers may be constrained in their communication,
                  special individuals create unofficial channels where team
                  members feel safe to share information. Acting as social hubs
                  or &quot;speakeasies,&quot; they foster trust and enable the
                  free flow of timely, factual information, which helps
                  colleagues make better decisions and navigate turmoil. Despite
                  their critical function in preventing team collapse and
                  reducing isolation, this &quot;glue work&quot; is typically
                  not formally recognized or compensated.
                </p>
              </div>
            </div>
            <p class="more">
              <a href="/series/unsung-team-roles/glue-people/">Read more …</a>
            </p>
          </div>
        </div>
      </div>

      <div
        class="post-summary"
        itemscope=""
        itemtype="https://schema.org/BlogPosting"
      >
        <link itemprop="isPartOf" itemtype="https://schema.org/Blog" href="/" />
        <h2 class="title">
          <a itemprop="url" href="/posts/an-intuition-on-entropy/">
            <span itemprop="name">An Intuition on Shannon Entropy</span>
          </a>
        </h2>
        <div class="summary-row">
          <a href="/posts/an-intuition-on-entropy/">
            <img
              src="/img/4ywdW_OSoN-600.png"
              alt="An allegorical pencil drawing of an ornate scale. The left pan represents &#39;Information&#39; with a neat pile of books and scrolls. The right pan represents &#39;Uncertainty&#39; with a chaotic vortex of dissolving papers, gears, and symbols. The scale is in perfect equilibrium, illustrating the conceptual balance between order and disorder."
              class="hero"
              width="600"
              height="600"
            />
          </a>

          <div>
            <nav>
              <small>
                Published on
                <time datetime="2025-09-27" itemprop="datePublished"
                  >September 27, 2025</time
                >.
              </small>
              <span></span>
              <menu class="tags">
                <li>
                  <span class="tag">
                    #<a href="/tags/privacy/">Privacy</a>
                  </span>
                </li>
                <li>
                  <span class="tag">
                    #<a href="/tags/programming/">Programming</a>
                  </span>
                </li>
                <li>
                  <span class="tag">
                    #<a href="/tags/entropy/">Entropy</a>
                  </span>
                </li>
              </menu>
            </nav>
            <div class="summary-row">
              <div itemprop="abstract">
                <p>
                  Develop an intuition for Shannon entropy as a measure of
                  information content. Using the game 'Guess Who' as a practical
                  example, this post explains how entropy quantifies the
                  reduction in ambiguity and builds up the mathematical
                  formulation from basic principles.
                </p>
              </div>
            </div>
            <p class="more">
              <a href="/posts/an-intuition-on-entropy/">Read more …</a>
            </p>
          </div>
        </div>
      </div>
    </footer>

    <script
      async=""
      src="https://www.googletagmanager.com/gtag/js?id=G-GSREL2EZ4Y"
    ></script>
    <script>
      var dnt,
        doNotTrack = !1;
      if (
        (!1 &&
          ((dnt =
            navigator.doNotTrack ||
            window.doNotTrack ||
            navigator.msDoNotTrack),
          (doNotTrack = dnt == "1" || dnt == "yes")),
        !doNotTrack)
      ) {
        window.dataLayer = window.dataLayer || [];
        function gtag() {
          dataLayer.push(arguments);
        }
        (gtag("js", new Date()), gtag("config", "G-GSREL2EZ4Y"));
      }
    </script>
  </body>
</html>
