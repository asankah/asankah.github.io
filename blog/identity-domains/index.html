<!doctype html><html xmlns=http://www.w3.org/1999/xhtml lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Identity Domains</title><link rel=stylesheet href=/css/style.css></head><body><section class=section><div class=container><nav id=nav-main class=nav><div id=nav-name class=nav-left><a id=nav-anchor class=nav-item href=https://asankah.github.io/><h1 id=nav-heading class="title is-4">Asanka Herath</h1></a></div><div class=nav-right><nav id=nav-items class="nav-item level is-mobile"></nav></div></nav><nav class=nav></nav></div></section><section class=section><div class=container><div class="subtitle tags is-6 is-pulled-right"></div><h2 class="subtitle is-6">May 1, 2020 | 00:00</h2><h1 class=title>Identity Domains</h1><div class=content><p><img src=/images/identity-domains.png alt="Diagram of example identity domains described below"></p><p>Above is a diagram showing relationships between clusters of documents and
identity domains. <code>foo.example</code> and <code>baz.example</code> belong to the same first party
set. <code>a.example</code> has no first-party relationship with any other domain.</p><blockquote><p>An <strong><em>Identity domain</em></strong> is a scope within which we consider it a given that
the user has a shared or trivially joinable identity.</p></blockquote><p>The “Identity domain” has the following properties:</p><ul><li><p>All
<a href=https://html.spec.whatwg.org/multipage/browsers.html#active-document>active documents</a>
in
<a href=https://html.spec.whatwg.org/multipage/browsers.html#list-of-the-descendant-browsing-contexts>descendent browsing contexts</a>
belong to the same <strong><em>identity domain</em></strong> as the active document in the
<a href=https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context>top-level browsing context</a>.</p><p><em>(See each cluster of browsing contexts in the diagram above)</em></p></li><li><p>All active documents in top-level browsing contexts that share the same
<a href=https://html.spec.whatwg.org/multipage/webappapis.html#site>site</a> also
share the same <strong><em>identity domain</em></strong>.</p><p><em>(In the diagram above, <code>foo.example</code> (cluster 1) and <code>baz.example</code> (cluster
2) belong to the same first-party set, hence they are considered to belong
to the same identity domain. However a.example in cluster 3 does not belong
to the same identity domain because there’s no first party relation between
a.example and any other top level domain in the diagram.)</em></p></li><li><p>All <strong>private client state</strong> (open sockets, socket pools, cookies, storage,
permissions / content settings, transient caches of credentials, cached
resources, service workers) for all documents included in an identity domain
also belong to the <strong><em>identity domain</em></strong>.</p></li><li><p><strong><em>Identity domains</em></strong> don’t span browser profiles.</p><p><em>(See clusters 1 and 4 in the diagram above. Both share top-level origins,
but don’t share identity domains because they are in two different browser
profiles.)</em></p></li><li><p><strong><em>Identity domains</em></strong> don’t span browsers.</p><p><em>(Derived from above).</em></p></li><li><p><strong><em>Identity domains</em></strong> don’t survive browsing data erasures.</p><p><em>(“Clear browsing data” effectively ends all identity domains.)</em></p></li></ul><h2 id=notes>Notes</h2><ul><li><p>The identity domain is a privacy boundary. The boundary is something that’s
asserted by the UA and doesn’t depend on the cooperation of sites. I.e.
assume that sites involved are worst case actors.</p><ul><li>Not to be confused with security boundaries like those imposed via
<a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP>Content Security Policy</a>.</li></ul></li><li><p>The definition assume that sites can share information out-of-band. I.e the
boundary should be assertable even if sites collude.</p><ul><li>The same site can appear in multiple identity domains. For example,
re-identification is equivalent to a single site joining an identity
across disjoint domains.</li></ul></li><li><p>Two identity domains can be linked externally by sharing a unique identifier
between the two domains.</p><ul><li><p>WRT federated identity (as detailed in
<a href=https://github.com/samuelgoto/WebID>WebID</a>) multiple relying parties
join identity domains by virtue of shared unique identifiers like email
address. Similarly identity providers can also generate and use unique
identifiers linking domains.</p></li><li><p>Using the same email address in multiple identity domains can
effectively join the domains. More examples exist, but you get the idea.</p></li><li><p>We likely need another term for describing externally joined identity
domains. In these cases the UA doesn’t necessarily know or can prevent
joined identity domains.</p></li></ul></li><li><p>Concepts like “logging out” can be defined in terms of destroying an
identity domain on the User Agent.</p></li><li><p>Destroying an identity domain must necessarily remove all associated local
storage, both transient and persisted. This requires a clear demarcation of
which constructs “belong” to which identity domain.</p></li><li><p>As a consequence, “Clear browsing data” requires unloading the active
document from all affected browsing contexts. Otherwise the identity leaks
across identity domains. As an added bonus, resetting an identity domain
requires clearing all client-side state. There’s no such thing as a partial
reset.</p></li></ul></div></div></section><footer><div class="container has-text-centered"><p></p></div><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-169355711-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></footer></body></html>